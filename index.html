<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BYMA Stocks & CEDEARs Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const BYMAStocksTracker = () => {
            const [stocks, setStocks] = useState([]);
            const [loading, setLoading] = useState(false);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [sortBy, setSortBy] = useState('variation');
            const [filterStrategy, setFilterStrategy] = useState('all');
            const [assetType, setAssetType] = useState('all');
            const [showGalpones, setShowGalpones] = useState(false);

            const sampleStocks = [
                { ticker: 'GGAL', name: 'Grupo Financiero Galicia', sector: 'Financiero', price: 580.50, prevClose: 565.00, type: 'local' },
                { ticker: 'YPF', name: 'YPF Sociedad AnÃ³nima', sector: 'EnergÃ­a', price: 425.80, prevClose: 438.20, type: 'local' },
                { ticker: 'PAMP', name: 'Pampa EnergÃ­a', sector: 'EnergÃ­a', price: 310.25, prevClose: 295.00, type: 'local' },
                { ticker: 'BMA', name: 'Banco Macro', sector: 'Financiero', price: 892.40, prevClose: 870.00, type: 'local' },
                { ticker: 'VIST', name: 'Vista Energy', sector: 'EnergÃ­a', price: 156.70, prevClose: 160.50, type: 'local' },
                { ticker: 'TXAR', name: 'Ternium Argentina', sector: 'Siderurgia', price: 201.30, prevClose: 198.00, type: 'local' },
                { ticker: 'ALUA', name: 'Aluar Aluminio Argentino', sector: 'Metalurgia', price: 178.90, prevClose: 185.40, type: 'local' },
                { ticker: 'LOMA', name: 'Loma Negra', sector: 'ConstrucciÃ³n', price: 125.60, prevClose: 122.30, type: 'local' },
                { ticker: 'TGSU2', name: 'Transportadora de Gas del Sur', sector: 'EnergÃ­a', price: 267.80, prevClose: 255.00, type: 'local' },
                { ticker: 'EDN', name: 'Edenor', sector: 'Servicios', price: 89.45, prevClose: 92.10, type: 'local' },
                
                { ticker: 'AAPL', name: 'Apple Inc.', sector: 'TecnologÃ­a', price: 18450.00, prevClose: 18200.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'GOOGL', name: 'Alphabet Inc.', sector: 'TecnologÃ­a', price: 15280.00, prevClose: 15450.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'MSFT', name: 'Microsoft Corporation', sector: 'TecnologÃ­a', price: 22100.00, prevClose: 21850.00, type: 'cedear', country: 'USA', ratio: '5:1' },
                { ticker: 'TSLA', name: 'Tesla Inc.', sector: 'Automotriz', price: 12670.00, prevClose: 13100.00, type: 'cedear', country: 'USA', ratio: '2:1' },
                { ticker: 'AMZN', name: 'Amazon.com Inc.', sector: 'E-commerce', price: 19800.00, prevClose: 19450.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'META', name: 'Meta Platforms Inc.', sector: 'TecnologÃ­a', price: 9350.00, prevClose: 9580.00, type: 'cedear', country: 'USA', ratio: '2:1' },
                { ticker: 'NVDA', name: 'NVIDIA Corporation', sector: 'Semiconductores', price: 14250.00, prevClose: 13800.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'KO', name: 'The Coca-Cola Company', sector: 'Bebidas', price: 6780.00, prevClose: 6650.00, type: 'cedear', country: 'USA', ratio: '1:1' },
                { ticker: 'DIS', name: 'The Walt Disney Company', sector: 'Entretenimiento', price: 10450.00, prevClose: 10680.00, type: 'cedear', country: 'USA', ratio: '1:1' },
                { ticker: 'BABA', name: 'Alibaba Group', sector: 'E-commerce', price: 8920.00, prevClose: 9150.00, type: 'cedear', country: 'China', ratio: '2:1' },
                { ticker: 'GOLD', name: 'Barrick Gold Corporation', sector: 'MinerÃ­a', price: 1850.00, prevClose: 1820.00, type: 'cedear', country: 'CanadÃ¡', ratio: '1:1' },
                { ticker: 'MELI', name: 'MercadoLibre Inc.', sector: 'E-commerce', price: 24500.00, prevClose: 23900.00, type: 'cedear', country: 'Argentina', ratio: '10:1' },
                
                { ticker: 'HOOD', name: 'Robinhood Markets Inc.', sector: 'Fintech', price: 3280.00, prevClose: 3150.00, type: 'cedear', country: 'USA', ratio: '1:1', category: 'galpones' },
                { ticker: 'CRWD', name: 'CrowdStrike Holdings Inc.', sector: 'Ciberseguridad', price: 38900.00, prevClose: 39500.00, type: 'cedear', country: 'USA', ratio: '10:1', category: 'galpones' },
                { ticker: 'OKLO', name: 'Oklo Inc.', sector: 'EnergÃ­a Nuclear', price: 1580.00, prevClose: 1450.00, type: 'cedear', country: 'USA', ratio: '1:1', category: 'galpones' },
                { ticker: 'RKLB', name: 'Rocket Lab USA Inc.', sector: 'Aeroespacial', price: 2890.00, prevClose: 2750.00, type: 'cedear', country: 'USA', ratio: '1:1', category: 'galpones' },
                { ticker: 'ALAB', name: 'Astera Labs Inc.', sector: 'Semiconductores', price: 8920.00, prevClose: 8650.00, type: 'cedear', country: 'USA', ratio: '2:1', category: 'galpones' },
            ];

            const calculateMetrics = (stock) => {
                const variation = ((stock.price - stock.prevClose) / stock.prevClose) * 100;
                const sma20 = stock.price * (1 - (Math.random() * 0.05 - 0.025));
                const sma50 = stock.price * (1 - (Math.random() * 0.08 - 0.04));
                const rsi = variation > 0 ? 50 + Math.random() * 30 : 20 + Math.random() * 30;
                const high52w = stock.price * (1 + Math.random() * 0.15 + 0.05);
                const low52w = stock.price * (1 - Math.random() * 0.15 - 0.05);
                const atr = stock.price * (0.02 + Math.random() * 0.03);
                
                return { variation, sma20, sma50, rsi, high52w, low52w, atr };
            };

            const determineStrategy = (stock, metrics) => {
                const { variation, rsi, sma20, sma50, high52w, low52w, atr } = metrics;
                const price = stock.price;
                
                const fibRange = high52w - low52w;
                const fib618 = price + (fibRange * 0.618 * 0.15);
                const fib382 = price - (fibRange * 0.382 * 0.15);
                const atrTarget = price + (atr * 2.5);
                const atrStop = price - (atr * 1.5);
                const resistance = Math.max(sma50 * 1.05, high52w * 0.95);
                const support = Math.min(sma50 * 0.95, low52w * 1.05);
                let riskRewardMultiplier = 2;
                if (rsi < 25) riskRewardMultiplier = 3;
                if (rsi > 75) riskRewardMultiplier = 1.5;
                
                let simpleTarget, simpleStop, target, stop, type, signal, reasoning, methods;
                
                if (rsi < 30 && price < sma20) {
                    simpleTarget = price * 1.08;
                    simpleStop = price * 0.95;
                    stop = Math.max(fib382, atrStop, support);
                    const riskPerShare = price - stop;
                    target = Math.min(price + (riskPerShare * riskRewardMultiplier), fib618, resistance);
                    type = 'BUY';
                    signal = 'Sobreventa';
                    reasoning = 'RSI sobreventa + soportes confirmados';
                    methods = 'Fibonacci + ATR + R/R 1:' + riskRewardMultiplier;
                } else if (price > sma20 && sma20 > sma50 && variation > 1) {
                    simpleTarget = price * 1.12;
                    simpleStop = price * 0.93;
                    stop = Math.max(sma20 * 0.97, atrStop);
                    const riskPerShare = price - stop;
                    target = Math.min(price + (riskPerShare * 2.5), atrTarget, resistance);
                    type = 'BUY';
                    signal = 'Tendencia Alcista';
                    reasoning = 'Precio sobre SMAs + momentum positivo';
                    methods = 'SMA + ATR + Resistencias';
                } else if (rsi > 70 && price > sma20) {
                    simpleTarget = price * 0.92;
                    simpleStop = price * 1.05;
                    stop = Math.min(fib618, price * 1.05);
                    const riskPerShare = stop - price;
                    target = Math.max(price - (riskPerShare * riskRewardMultiplier), support, sma50);
                    type = 'SELL';
                    signal = 'Sobrecompra';
                    reasoning = 'RSI sobrecompra + resistencia alcanzada';
                    methods = 'Fibonacci + Soportes + R/R';
                } else if (price < sma20 && sma20 < sma50 && variation < -1) {
                    simpleTarget = price * 0.88;
                    simpleStop = price * 1.07;
                    stop = Math.min(sma20 * 1.03, price * 1.07);
                    const riskPerShare = stop - price;
                    target = Math.max(price - (riskPerShare * 2), support, low52w * 1.05);
                    type = 'SELL';
                    signal = 'Tendencia Bajista';
                    reasoning = 'Precio bajo SMAs + momentum negativo';
                    methods = 'SMA + Soportes + ATR';
                } else {
                    simpleTarget = price * 1.05;
                    simpleStop = price * 0.97;
                    stop = price * 0.97;
                    target = Math.min(price * 1.05, resistance * 0.98);
                    type = 'HOLD';
                    signal = 'Neutral';
                    reasoning = 'Sin seÃ±al clara';
                    methods = 'Niveles conservadores';
                }
                
                return {
                    type, signal, reasoning, methods,
                    entry: price * (type === 'BUY' ? 0.99 : 1.01),
                    target, targetSimple: simpleTarget,
                    stop, stopSimple: simpleStop,
                    confidence: type === 'HOLD' ? 'Baja' : 'Alta'
                };
            };

            const loadStocks = () => {
                setLoading(true);
                setTimeout(() => {
                    const enrichedStocks = sampleStocks.map(stock => {
                        const metrics = calculateMetrics(stock);
                        const strategy = determineStrategy(stock, metrics);
                        return { ...stock, ...metrics, strategy };
                    });
                    setStocks(enrichedStocks);
                    setLastUpdate(new Date());
                    setLoading(false);
                }, 1000);
            };

            useEffect(() => { loadStocks(); }, []);

            const sortedStocks = [...stocks].sort((a, b) => {
                if (sortBy === 'variation') return b.variation - a.variation;
                if (sortBy === 'price') return b.price - a.price;
                if (sortBy === 'ticker') return a.ticker.localeCompare(b.ticker);
                return 0;
            });

            const filteredStocks = sortedStocks.filter(stock => {
                const strategyMatch = filterStrategy === 'all' || stock.strategy.type === filterStrategy;
                const typeMatch = assetType === 'all' || stock.type === assetType;
                const galponesMatch = !showGalpones || stock.category === 'galpones';
                return strategyMatch && typeMatch && galponesMatch;
            });

            const stats = {
                total: stocks.length,
                local: stocks.filter(s => s.type === 'local').length,
                cedear: stocks.filter(s => s.type === 'cedear').length,
                galpones: stocks.filter(s => s.category === 'galpones').length,
                buySignals: stocks.filter(s => s.strategy?.type === 'BUY').length,
                sellSignals: stocks.filter(s => s.strategy?.type === 'SELL').length,
            };

            return (
                <div className="w-full min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800">BYMA Stocks & CEDEARs Tracker</h1>
                                    <p className="text-gray-600 mt-1">Mercado de Valores de Buenos Aires</p>
                                </div>
                                <button
                                    onClick={loadStocks}
                                    disabled={loading}
                                    className="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50"
                                >
                                    ðŸ”„ {loading ? 'Cargando...' : 'Actualizar'}
                                </button>
                            </div>
                            
                            {lastUpdate && (
                                <p className="text-sm text-gray-500">
                                    Ãšltima actualizaciÃ³n: {lastUpdate.toLocaleTimeString('es-AR')}
                                </p>
                            )}

                            <div className="grid grid-cols-2 md:grid-cols-6 gap-4 mt-4">
                                <div className="bg-blue-50 rounded-lg p-3">
                                    <div className="text-xs text-blue-600 font-medium">Total Activos</div>
                                    <div className="text-2xl font-bold text-blue-700">{stats.total}</div>
                                </div>
                                <div className="bg-green-50 rounded-lg p-3">
                                    <div className="text-xs text-green-600 font-medium">Locales</div>
                                    <div className="text-2xl font-bold text-green-700">{stats.local}</div>
                                </div>
                                <div className="bg-purple-50 rounded-lg p-3">
                                    <div className="text-xs text-purple-600 font-medium">CEDEARs</div>
                                    <div className="text-2xl font-bold text-purple-700">{stats.cedear}</div>
                                </div>
                                <div className="bg-orange-50 rounded-lg p-3 cursor-pointer hover:bg-orange-100" onClick={() => setShowGalpones(!showGalpones)}>
                                    <div className="text-xs text-orange-600 font-medium">ðŸš€ Galpones</div>
                                    <div className="text-2xl font-bold text-orange-700">{stats.galpones}</div>
                                    {showGalpones && <div className="text-xs text-orange-600">âœ“ Activo</div>}
                                </div>
                                <div className="bg-emerald-50 rounded-lg p-3">
                                    <div className="text-xs text-emerald-600 font-medium">Compra</div>
                                    <div className="text-2xl font-bold text-emerald-700">{stats.buySignals}</div>
                                </div>
                                <div className="bg-red-50 rounded-lg p-3">
                                    <div className="text-xs text-red-600 font-medium">Venta</div>
                                    <div className="text-2xl font-bold text-red-700">{stats.sellSignals}</div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-4 mb-6">
                            <div className="flex flex-wrap gap-4">
                                <select value={assetType} onChange={(e) => setAssetType(e.target.value)} className="px-4 py-2 border rounded-lg">
                                    <option value="all">Todos los activos</option>
                                    <option value="local">Acciones Locales</option>
                                    <option value="cedear">CEDEARs</option>
                                </select>
                                <select value={sortBy} onChange={(e) => setSortBy(e.target.value)} className="px-4 py-2 border rounded-lg">
                                    <option value="variation">Ordenar por VariaciÃ³n</option>
                                    <option value="price">Ordenar por Precio</option>
                                    <option value="ticker">Ordenar por Ticker</option>
                                </select>
                                <select value={filterStrategy} onChange={(e) => setFilterStrategy(e.target.value)} className="px-4 py-2 border rounded-lg">
                                    <option value="all">Todas las estrategias</option>
                                    <option value="BUY">Solo Compra</option>
                                    <option value="SELL">Solo Venta</option>
                                    <option value="HOLD">Solo Mantener</option>
                                </select>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg overflow-x-auto">
                            <table className="w-full text-sm">
                                <thead className="bg-indigo-600 text-white">
                                    <tr>
                                        <th className="px-3 py-2 text-left">Ticker</th>
                                        <th className="px-3 py-2 text-left">Empresa</th>
                                        <th className="px-3 py-2">Tipo</th>
                                        <th className="px-3 py-2 text-right">Precio</th>
                                        <th className="px-3 py-2 text-right">Var%</th>
                                        <th className="px-3 py-2">RSI</th>
                                        <th className="px-3 py-2">Estrategia</th>
                                        <th className="px-3 py-2 text-right">Entrada</th>
                                        <th className="px-3 py-2 text-right">Obj Simple</th>
                                        <th className="px-3 py-2">% Obj S</th>
                                        <th className="px-3 py-2 text-right">Obj Robusto</th>
                                        <th className="px-3 py-2">% Obj R</th>
                                        <th className="px-3 py-2 text-right">Stop S</th>
                                        <th className="px-3 py-2 text-right">Stop R</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {filteredStocks.map((s, i) => {
                                        const pctSimple = ((s.strategy.targetSimple - s.price) / s.price * 100);
                                        const pctRobust = ((s.strategy.target - s.price) / s.price * 100);
                                        return (
                                            <tr key={s.ticker} className={i % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                <td className="px-3 py-3">
                                                    <div className="font-bold text-indigo-600">{s.ticker}</div>
                                                    {s.ratio && <div className="text-xs text-gray-500">{s.ratio}</div>}
                                                    {s.category === 'galpones' && <div className="text-xs text-orange-600 font-bold">ðŸš€ GALPÃ“N</div>}
                                                </td>
                                                <td className="px-3 py-3">
                                                    <div className="font-medium">{s.name}</div>
                                                    <div className="text-xs text-gray-500">{s.sector}{s.country && ` â€¢ ${s.country}`}</div>
                                                </td>
                                                <td className="px-3 py-3 text-center">
                                                    <span className={`px-2 py-1 rounded text-xs font-bold ${s.type === 'cedear' ? 'bg-purple-100 text-purple-700' : 'bg-green-100 text-green-700'}`}>
                                                        {s.type === 'cedear' ? 'CEDEAR' : 'LOCAL'}
                                                    </span>
                                                </td>
                                                <td className="px-3 py-3 text-right font-bold">${s.price.toLocaleString('es-AR', {minimumFractionDigits: 2})}</td>
                                                <td className="px-3 py-3 text-right">
                                                    <span className={`px-2 py-1 rounded ${s.variation > 0 ? 'bg-green-50 text-green-600' : 'bg-red-50 text-red-600'}`}>
                                                        {s.variation > 0 ? 'â†‘' : 'â†“'} {s.variation.toFixed(2)}%
                                                    </span>
                                                </td>
                                                <td className="px-3 py-3 text-center">
                                                    <span className={`px-2 py-1 rounded ${s.rsi < 30 ? 'bg-green-100 text-green-800' : s.rsi > 70 ? 'bg-red-100 text-red-800' : 'bg-gray-100'}`}>
                                                        {s.rsi.toFixed(0)}
                                                    </span>
                                                </td>
                                                <td className="px-3 py-3">
                                                    <div className={`border rounded p-2 text-xs ${s.strategy.type === 'BUY' ? 'bg-green-50 border-green-300' : s.strategy.type === 'SELL' ? 'bg-red-50 border-red-300' : 'bg-gray-50'}`}>
                                                        <div className="font-bold">{s.strategy.type}</div>
                                                        <div className="text-xs">{s.strategy.signal}</div>
                                                    </div>
                                                </td>
                                                <td className="px-3 py-3 text-right">${s.strategy.entry.toFixed(2)}</td>
                                                <td className="px-3 py-3 text-right text-gray-600 font-medium">${s.strategy.targetSimple.toFixed(2)}</td>
                                                <td className="px-3 py-3 text-center">
                                                    <span className={`px-2 py-1 rounded-full font-bold ${pctSimple > 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                                                        {pctSimple > 0 ? 'â†‘' : 'â†“'} {Math.abs(pctSimple).toFixed(1)}%
                                                    </span>
                                                </td>
                                                <td className="px-3 py-3 text-right text-green-600 font-bold">${s.strategy.target.toFixed(2)}</td>
                                                <td className="px-3 py-3 text-center">
                                                    <span className={`px-2 py-1 rounded-full font-bold border-2 ${pctRobust > 0 ? 'bg-emerald-100 text-emerald-700 border-emerald-400' : 'bg-rose-100 text-rose-700 border-rose-400'}`}>
                                                        {pctRobust > 0 ? 'â†‘' : 'â†“'} {Math.abs(pctRobust).toFixed(1)}%
                                                    </span>
                                                </td>
                                                <td className="px-3 py-3 text-right text-gray-600">${s.strategy.stopSimple.toFixed(2)}</td>
                                                <td className="px-3 py-3 text-right text-red-600 font-bold">${s.strategy.stop.toFixed(2)}</td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-6 mt-6">
                            <h3 className="font-bold text-lg mb-4">ðŸ“Š InformaciÃ³n</h3>
                            
                            <div className="grid md:grid-cols-2 gap-4 mb-4">
                                <div className="p-4 bg-purple-50 rounded-lg">
                                    <h4 className="font-bold text-purple-900 mb-2">Â¿QuÃ© son los CEDEARs?</h4>
                                    <p className="text-sm text-purple-800">Certificados que representan acciones extranjeras. Te permiten invertir en empresas como Apple, Google, etc. desde BYMA en pesos.</p>
                                </div>
                                <div className="p-4 bg-orange-50 rounded-lg">
                                    <h4 className="font-bold text-orange-900 mb-2">ðŸš€ Galpones</h4>
                                    <p className="text-sm text-orange-800">Empresas de alto crecimiento en sectores disruptivos (fintech, ciberseguridad, aeroespacial). Mayor riesgo y potencial.</p>
                                </div>
                            </div>

                            <div className="p-4 bg-indigo-50 rounded-lg">
                                <h4 className="font-bold mb-2">ComparaciÃ³n de MÃ©todos</h4>
                                <div className="grid md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <strong>MÃ©todo Simple:</strong> Porcentajes fijos (+8%/+12% objetivos). FÃ¡cil pero no considera volatilidad.
                                    </div>
                                    <div className="text-green-700">
                                        <strong>MÃ©todo Robusto âœ“:</strong> Fibonacci + ATR + Soportes/Resistencias + Risk/Reward dinÃ¡mico. MÃ¡s preciso y adaptativo.
                                    </div>
                                </div>
                            </div>

                            <p className="text-xs text-gray-500 mt-4 italic">
                                <strong>Disclaimer:</strong> Datos simulados solo para fines educativos. Consulte a un asesor financiero.
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<BYMAStocksTracker />, document.getElementById('root'));
    </script>
</body>
</html>
