<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BYMA Stocks & CEDEARs Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const TrendingUp = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const TrendingDown = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                <polyline points="17 18 23 18 23 12"></polyline>
            </svg>
        );

        const RefreshCw = ({ className }) => (
            <svg className={className} width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );

        const AlertCircle = ({ className }) => (
            <svg className={className} width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const DollarSign = ({ className }) => (
            <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const Globe = ({ className }) => (
            <svg className={className} width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
        );

        const BYMAStocksTracker = () => {
            const [stocks, setStocks] = useState([]);
            const [loading, setLoading] = useState(false);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [sortBy, setSortBy] = useState('variation');
            const [filterStrategy, setFilterStrategy] = useState('all');
            const [assetType, setAssetType] = useState('all');
            const [showGalpones, setShowGalpones] = useState(false);

            const sampleStocks = [
                { ticker: 'GGAL', name: 'Grupo Financiero Galicia', sector: 'Financiero', price: 580.50, prevClose: 565.00, type: 'local' },
                { ticker: 'YPF', name: 'YPF Sociedad An√≥nima', sector: 'Energ√≠a', price: 425.80, prevClose: 438.20, type: 'local' },
                { ticker: 'PAMP', name: 'Pampa Energ√≠a', sector: 'Energ√≠a', price: 310.25, prevClose: 295.00, type: 'local' },
                { ticker: 'BMA', name: 'Banco Macro', sector: 'Financiero', price: 892.40, prevClose: 870.00, type: 'local' },
                { ticker: 'VIST', name: 'Vista Energy', sector: 'Energ√≠a', price: 156.70, prevClose: 160.50, type: 'local' },
                { ticker: 'TXAR', name: 'Ternium Argentina', sector: 'Siderurgia', price: 201.30, prevClose: 198.00, type: 'local' },
                { ticker: 'ALUA', name: 'Aluar Aluminio Argentino', sector: 'Metalurgia', price: 178.90, prevClose: 185.40, type: 'local' },
                { ticker: 'LOMA', name: 'Loma Negra', sector: 'Construcci√≥n', price: 125.60, prevClose: 122.30, type: 'local' },
                { ticker: 'TGSU2', name: 'Transportadora de Gas del Sur', sector: 'Energ√≠a', price: 267.80, prevClose: 255.00, type: 'local' },
                { ticker: 'EDN', name: 'Edenor', sector: 'Servicios', price: 89.45, prevClose: 92.10, type: 'local' },
                
                // CEDEARs
                { ticker: 'AAPL', name: 'Apple Inc.', sector: 'Tecnolog√≠a', price: 18450.00, prevClose: 18200.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'GOOGL', name: 'Alphabet Inc.', sector: 'Tecnolog√≠a', price: 15280.00, prevClose: 15450.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'MSFT', name: 'Microsoft Corporation', sector: 'Tecnolog√≠a', price: 22100.00, prevClose: 21850.00, type: 'cedear', country: 'USA', ratio: '5:1' },
                { ticker: 'TSLA', name: 'Tesla Inc.', sector: 'Automotriz', price: 12670.00, prevClose: 13100.00, type: 'cedear', country: 'USA', ratio: '2:1' },
                { ticker: 'AMZN', name: 'Amazon.com Inc.', sector: 'E-commerce', price: 19800.00, prevClose: 19450.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'META', name: 'Meta Platforms Inc.', sector: 'Tecnolog√≠a', price: 9350.00, prevClose: 9580.00, type: 'cedear', country: 'USA', ratio: '2:1' },
                { ticker: 'NVDA', name: 'NVIDIA Corporation', sector: 'Semiconductores', price: 14250.00, prevClose: 13800.00, type: 'cedear', country: 'USA', ratio: '10:1' },
                { ticker: 'KO', name: 'The Coca-Cola Company', sector: 'Bebidas', price: 6780.00, prevClose: 6650.00, type: 'cedear', country: 'USA', ratio: '1:1' },
                { ticker: 'DIS', name: 'The Walt Disney Company', sector: 'Entretenimiento', price: 10450.00, prevClose: 10680.00, type: 'cedear', country: 'USA', ratio: '1:1' },
                { ticker: 'BABA', name: 'Alibaba Group', sector: 'E-commerce', price: 8920.00, prevClose: 9150.00, type: 'cedear', country: 'China', ratio: '2:1' },
                { ticker: 'GOLD', name: 'Barrick Gold Corporation', sector: 'Miner√≠a', price: 1850.00, prevClose: 1820.00, type: 'cedear', country: 'Canad√°', ratio: '1:1' },
                { ticker: 'MELI', name: 'MercadoLibre Inc.', sector: 'E-commerce', price: 24500.00, prevClose: 23900.00, type: 'cedear', country: 'Argentina', ratio: '10:1' },
                
                // Galpones (High Growth/Speculative)
                { ticker: 'HOOD', name: 'Robinhood Markets Inc.', sector: 'Fintech', price: 3280.00, prevClose: 3150.00, type: 'cedear', country: 'USA', ratio: '1:1', category: 'galpones' },
                { ticker: 'CRWD', name: 'CrowdStrike Holdings Inc.', sector: 'Ciberseguridad', price: 38900.00, prevClose: 39500.00, type: 'cedear', country: 'USA', ratio: '10:1', category: 'galpones' },
                { ticker: 'OKLO', name: 'Oklo Inc.', sector: 'Energ√≠a Nuclear', price: 1580.00, prevClose: 1450.00, type: 'cedear', country: 'USA', ratio: '1:1', category: 'galpones' },
                { ticker: 'RKLB', name: 'Rocket Lab USA Inc.', sector: 'Aeroespacial', price: 2890.00, prevClose: 2750.00, type: 'cedear', country: 'USA', ratio: '1:1', category: 'galpones' },
                { ticker: 'ALAB', name: 'Astera Labs Inc.', sector: 'Semiconductores', price: 8920.00, prevClose: 8650.00, type: 'cedear', country: 'USA', ratio: '2:1', category: 'galpones' },
            ];

            const calculateMetrics = (stock) => {
                const variation = ((stock.price - stock.prevClose) / stock.prevClose) * 100;
                const volatility = Math.abs(variation);
                const sma20 = stock.price * (1 - (Math.random() * 0.05 - 0.025));
                const sma50 = stock.price * (1 - (Math.random() * 0.08 - 0.04));
                const rsi = variation > 0 ? 50 + Math.random() * 30 : 20 + Math.random() * 30;
                
                // Simular datos hist√≥ricos para c√°lculos m√°s avanzados
                const high52w = stock.price * (1 + Math.random() * 0.15 + 0.05); // +5% a +20%
                const low52w = stock.price * (1 - Math.random() * 0.15 - 0.05);  // -5% a -20%
                const atr = stock.price * (0.02 + Math.random() * 0.03); // ATR entre 2-5% del precio
                
                return { variation, volatility, sma20, sma50, rsi, high52w, low52w, atr };
            };

            const calculateAdvancedTargets = (stock, metrics) => {
                const { rsi, sma20, sma50, high52w, low52w, atr } = metrics;
                const price = stock.price;
                
                // M√©todo 1: Fibonacci (basado en rango hist√≥rico)
                const fibRange = high52w - low52w;
                const fib618 = price + (fibRange * 0.618 * 0.15); // Escalado
                const fib382 = price - (fibRange * 0.382 * 0.15);
                
                // M√©todo 2: ATR (basado en volatilidad)
                const atrTarget = price + (atr * 2.5);
                const atrStop = price - (atr * 1.5);
                
                // M√©todo 3: Soportes/Resistencias (SMA + extremos)
                const resistance = Math.max(sma50 * 1.05, high52w * 0.95);
                const support = Math.min(sma50 * 0.95, low52w * 1.05);
                
                // M√©todo 4: Risk/Reward basado en RSI
                let riskRewardMultiplier = 2;
                if (rsi < 25) riskRewardMultiplier = 3; // Mayor potencial en sobreventa extrema
                if (rsi > 75) riskRewardMultiplier = 1.5; // Menor potencial en sobrecompra extrema
                
                return {
                    fib618, fib382, atrTarget, atrStop, resistance, support, riskRewardMultiplier
                };
            };

            const determineStrategy = (stock, metrics) => {
                const { variation, rsi, sma20, sma50 } = metrics;
                const price = stock.price;
                const targets = calculateAdvancedTargets(stock, metrics);
                
                // C√°lculo simple (m√©todo original)
                let simpleTarget, simpleStop;
                
                // Se√±al de COMPRA - Sobreventa fuerte
                if (rsi < 30 && price < sma20) {
                    simpleTarget = price * 1.08;
                    simpleStop = price * 0.95;
                    
                    const stop = Math.max(targets.fib382, targets.atrStop, targets.support);
                    const riskPerShare = price - stop;
                    const rewardPerShare = riskPerShare * targets.riskRewardMultiplier;
                    const target = Math.min(
                        price + rewardPerShare,
                        targets.fib618,
                        targets.resistance
                    );
                    
                    return {
                        type: 'BUY',
                        signal: 'Sobreventa',
                        entry: price * 0.98,
                        target: target,
                        targetSimple: simpleTarget,
                        stop: stop,
                        stopSimple: simpleStop,
                        confidence: 'Alta',
                        reasoning: 'RSI sobreventa + m√∫ltiples soportes confirmados',
                        methods: 'Fibonacci + ATR + Risk/Reward 1:' + targets.riskRewardMultiplier
                    };
                }
                
                // Se√±al de COMPRA - Tendencia Alcista
                if (price > sma20 && sma20 > sma50 && variation > 1) {
                    simpleTarget = price * 1.12;
                    simpleStop = price * 0.93;
                    
                    const stop = Math.max(sma20 * 0.97, targets.atrStop);
                    const riskPerShare = price - stop;
                    const target = Math.min(
                        price + (riskPerShare * 2.5),
                        targets.atrTarget,
                        targets.resistance
                    );
                    
                    return {
                        type: 'BUY',
                        signal: 'Tendencia Alcista',
                        entry: price * 0.995,
                        target: target,
                        targetSimple: simpleTarget,
                        stop: stop,
                        stopSimple: simpleStop,
                        confidence: 'Media-Alta',
                        reasoning: 'Precio sobre SMAs + momentum positivo',
                        methods: 'SMA + ATR + Resistencias t√©cnicas'
                    };
                }
                
                // Se√±al de VENTA - Sobrecompra
                if (rsi > 70 && price > sma20) {
                    simpleTarget = price * 0.92;
                    simpleStop = price * 1.05;
                    
                    const stop = Math.min(targets.fib618, price * 1.05);
                    const riskPerShare = stop - price;
                    const target = Math.max(
                        price - (riskPerShare * targets.riskRewardMultiplier),
                        targets.support,
                        sma50
                    );
                    
                    return {
                        type: 'SELL',
                        signal: 'Sobrecompra',
                        entry: price * 1.02,
                        target: target,
                        targetSimple: simpleTarget,
                        stop: stop,
                        stopSimple: simpleStop,
                        confidence: 'Alta',
                        reasoning: 'RSI sobrecompra + resistencia t√©cnica alcanzada',
                        methods: 'Fibonacci + Soportes + Risk/Reward'
                    };
                }
                
                // Se√±al de VENTA - Tendencia Bajista
                if (price < sma20 && sma20 < sma50 && variation < -1) {
                    simpleTarget = price * 0.88;
                    simpleStop = price * 1.07;
                    
                    const stop = Math.min(sma20 * 1.03, price * 1.07);
                    const riskPerShare = stop - price;
                    const target = Math.max(
                        price - (riskPerShare * 2),
                        targets.support,
                        targets.low52w * 1.05
                    );
                    
                    return {
                        type: 'SELL',
                        signal: 'Tendencia Bajista',
                        entry: price * 1.01,
                        target: target,
                        targetSimple: simpleTarget,
                        stop: stop,
                        stopSimple: simpleStop,
                        confidence: 'Media',
                        reasoning: 'Precio bajo SMAs + momentum negativo',
                        methods: 'SMA + Soportes hist√≥ricos + ATR'
                    };
                }
                
                // HOLD - Sin se√±al clara
                simpleTarget = price * 1.05;
                simpleStop = price * 0.97;
                
                const neutralStop = price * 0.97;
                const neutralTarget = Math.min(
                    price * 1.05,
                    targets.resistance * 0.98
                );
                
                return {
                    type: 'HOLD',
                    signal: 'Neutral',
                    entry: price,
                    target: neutralTarget,
                    targetSimple: simpleTarget,
                    stop: neutralStop,
                    stopSimple: simpleStop,
                    confidence: 'Baja',
                    reasoning: 'Sin se√±al clara - mercado en rango',
                    methods: 'Niveles t√©cnicos conservadores'
                };
            };

            const loadStocks = () => {
                setLoading(true);
                
                setTimeout(() => {
                    const enrichedStocks = sampleStocks.map(stock => {
                        const metrics = calculateMetrics(stock);
                        const strategy = determineStrategy(stock, metrics);
                        
                        return {
                            ...stock,
                            ...metrics,
                            strategy
                        };
                    });
                    
                    setStocks(enrichedStocks);
                    setLastUpdate(new Date());
                    setLoading(false);
                }, 1000);
            };

            useEffect(() => {
                loadStocks();
            }, []);

            const sortedStocks = [...stocks].sort((a, b) => {
                if (sortBy === 'variation') return b.variation - a.variation;
                if (sortBy === 'price') return b.price - a.price;
                if (sortBy === 'ticker') return a.ticker.localeCompare(b.ticker);
                return 0;
            });

            const filteredStocks = sortedStocks.filter(stock => {
                const strategyMatch = filterStrategy === 'all' || stock.strategy.type === filterStrategy;
                const typeMatch = assetType === 'all' || stock.type === assetType;
                const galponesMatch = !showGalpones || stock.category === 'galpones';
                return strategyMatch && typeMatch && galponesMatch;
            });

            const getVariationColor = (variation) => {
                if (variation > 2) return 'text-green-600 bg-green-50';
                if (variation > 0) return 'text-green-500 bg-green-50';
                if (variation < -2) return 'text-red-600 bg-red-50';
                return 'text-red-500 bg-red-50';
            };

            const getStrategyColor = (type) => {
                if (type === 'BUY') return 'bg-green-100 text-green-800 border-green-300';
                if (type === 'SELL') return 'bg-red-100 text-red-800 border-red-300';
                return 'bg-gray-100 text-gray-800 border-gray-300';
            };

            const stats = {
                total: stocks.length,
                local: stocks.filter(s => s.type === 'local').length,
                cedear: stocks.filter(s => s.type === 'cedear').length,
                galpones: stocks.filter(s => s.category === 'galpones').length,
                buySignals: stocks.filter(s => s.strategy?.type === 'BUY').length,
                sellSignals: stocks.filter(s => s.strategy?.type === 'SELL').length,
            };

            return (
                <div className="w-full min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800 flex items-center gap-2">
                                        <DollarSign className="text-indigo-600" />
                                        BYMA Stocks & CEDEARs Tracker
                                    </h1>
                                    <p className="text-gray-600 mt-1">Mercado de Valores de Buenos Aires</p>
                                </div>
                                <button
                                    onClick={loadStocks}
                                    disabled={loading}
                                    className="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50"
                                >
                                    <RefreshCw className={loading ? 'animate-spin' : ''} />
                                    Actualizar
                                </button>
                            </div>
                            
                            {lastUpdate && (
                                <p className="text-sm text-gray-500">
                                    √öltima actualizaci√≥n: {lastUpdate.toLocaleTimeString('es-AR')}
                                </p>
                            )}

                            {/* Stats */}
                            <div className="grid grid-cols-2 md:grid-cols-6 gap-4 mt-4">
                                <div className="bg-blue-50 rounded-lg p-3">
                                    <div className="text-xs text-blue-600 font-medium">Total Activos</div>
                                    <div className="text-2xl font-bold text-blue-700">{stats.total}</div>
                                </div>
                                <div className="bg-green-50 rounded-lg p-3">
                                    <div className="text-xs text-green-600 font-medium">Acciones Locales</div>
                                    <div className="text-2xl font-bold text-green-700">{stats.local}</div>
                                </div>
                                <div className="bg-purple-50 rounded-lg p-3">
                                    <div className="text-xs text-purple-600 font-medium">CEDEARs</div>
                                    <div className="text-2xl font-bold text-purple-700">{stats.cedear}</div>
                                </div>
                                <div className="bg-orange-50 rounded-lg p-3 cursor-pointer hover:bg-orange-100 transition" onClick={() => setShowGalpones(!showGalpones)}>
                                    <div className="text-xs text-orange-600 font-medium">üöÄ Galpones</div>
                                    <div className="text-2xl font-bold text-orange-700">{stats.galpones}</div>
                                    {showGalpones && <div className="text-xs text-orange-600 mt-1">‚úì Filtrado</div>}
                                </div>
                                <div className="bg-emerald-50 rounded-lg p-3">
                                    <div className="text-xs text-emerald-600 font-medium">Se√±ales Compra</div>
                                    <div className="text-2xl font-bold text-emerald-700">{stats.buySignals}</div>
                                </div>
                                <div className="bg-red-50 rounded-lg p-3">
                                    <div className="text-xs text-red-600 font-medium">Se√±ales Venta</div>
                                    <div className="text-2xl font-bold text-red-700">{stats.sellSignals}</div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-4 mb-6">
                            <div className="flex flex-wrap gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Tipo de activo:
                                    </label>
                                    <select
                                        value={assetType}
                                        onChange={(e) => setAssetType(e.target.value)}
                                        className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"
                                    >
                                        <option value="all">Todos</option>
                                        <option value="local">Acciones Locales</option>
                                        <option value="cedear">CEDEARs</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Ordenar por:
                                    </label>
                                    <select
                                        value={sortBy}
                                        onChange={(e) => setSortBy(e.target.value)}
                                        className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"
                                    >
                                        <option value="variation">Variaci√≥n %</option>
                                        <option value="price">Precio</option>
                                        <option value="ticker">Ticker</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Filtrar estrategia:
                                    </label>
                                    <select
                                        value={filterStrategy}
                                        onChange={(e) => setFilterStrategy(e.target.value)}
                                        className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"
                                    >
                                        <option value="all">Todas</option>
                                        <option value="BUY">Compra</option>
                                        <option value="SELL">Venta</option>
                                        <option value="HOLD">Mantener</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-indigo-600 text-white">
                                        <tr>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Ticker</th>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Empresa</th>
                                            <th className="px-4 py-3 text-center text-sm font-semibold">Tipo</th>
                                            <th className="px-4 py-3 text-right text-sm font-semibold">Precio</th>
                                            <th className="px-4 py-3 text-right text-sm font-semibold">Variaci√≥n %</th>
                                            <th className="px-4 py-3 text-center text-sm font-semibold">RSI</th>
                                            <th className="px-4 py-3 text-center text-sm font-semibold">Estrategia</th>
                                            <th className="px-4 py-3 text-right text-sm font-semibold">Entrada</th>
                                            <th className="px-4 py-3 text-right text-sm font-semibold">Objetivo Simple</th>
                                            <th className="px-4 py-3 text-center text-sm font-semibold">% a Objetivo Simple</th>
                                            <th className="px-4 py-3 text-right text-sm font-semibold">Objetivo Robusto</th>
                                            <th className="px-4 py-3 text-center text-sm font-semibold">% a Objetivo Robusto</th>
                                            <th className="px-4 py-3 text-right text-
